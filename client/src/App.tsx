import React, { useState } from 'react';
import axios from 'axios';
import './App.css';

import JohnLogo from './john-logo.svg';

function App() {
    const [pdfFilePath, setPdfFilePath] = useState<string>('');
    const [result, setResult] = useState<string | null>(null);
    const [error, setError] = useState<string | null>(null);

    const runScript = async (scriptName: string) => {
        try {
            const response = await axios.post<{ result: string; error: string }>('http://localhost:3001/run-script', {
                pdfFilePath,
                scriptName,
            });
            setResult(response.data.result);
            setError(response.data.error);
        } catch (error) {
            setError('Some error occurred :(');
        }
    };

    return (
        <div className="container">
            <img src={JohnLogo} alt="John the Ripper Logo" className="logo" />
            <h1>PDF Password Cracker Page</h1>
            <h2>Don't forget to start the server...</h2>
            <label>
                Enter PDF File Path:
                <input type="text" value={pdfFilePath} onChange={(e) => setPdfFilePath(e.target.value)} />
            </label>
            <br />
            <button className="primary" onClick={() => runScript('crackPDFpasswd')}>Crack Password!</button>
            <button className="secondary" onClick={() => runScript('crackAgain')}>Reset John the Ripper's cache</button>
            <br />
            <h2>Result:</h2>
            <div className="result-container">
                {result && <pre>{result}</pre>}
                {error && <p className="error-message">{error}</p>}
            </div>
        </div>
    );
}

export default App;
