import { exec } from "child_process";
import { promisify } from "util";

const execAsync = promisify(exec);

export async function runCommand(command: string) {
  const password = process.env.PASSWORD;

  if (command.includes("airodump-ng") && !command.includes("pkill")) {
    command += " > /dev/null 2>&1";
  }

  try {
    const { stdout, stderr } = await execAsync(
      `echo ${password} | sudo -S ${command}`,
      { maxBuffer: 1024 * 1024 }
    );
    console.log(command);
    if (stderr) {
      throw new Error(`Error executing command: ${stderr}`);
    }

    return stdout;
  } catch (error) { }
  
  return "";
}
